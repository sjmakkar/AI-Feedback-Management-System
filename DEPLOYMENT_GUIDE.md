# Vercel Deployment Guide

## Prerequisites
- GitHub account with your code pushed
- Vercel account (free at vercel.com)
- Backend and Frontend code ready

---

## Backend Deployment (FastAPI on Vercel)

### 1. Prepare Backend
```bash
cd backend
# Ensure requirements.txt has all dependencies
pip freeze > requirements.txt
```

### 2. Deploy Backend to Vercel

**Option A: Via CLI**
```bash
npm install -g vercel
cd backend
vercel --prod
```

**Option B: Via GitHub (Recommended)**
1. Push code to GitHub
2. Go to [vercel.com](https://vercel.com)
3. Click "New Project"
4. Import GitHub repository
5. Select "Other" as framework
6. Set root directory to `backend/`
7. Add environment variables (see below)
8. Deploy

### 3. Set Environment Variables in Vercel

In Vercel Project Settings → Environment Variables, add:

```
GEMINI_API_KEY=<your-gemini-api-key>
DATABASE_URL=<your-aiven-database-url>
```

**Note:** Copy your actual API keys from the `.env` file in your local project. Do not commit secrets to GitHub.

### 4. Get Backend URL
After deployment, Vercel will show: `https://your-backend.vercel.app`

Save this URL!

---

## Frontend Deployment (Next.js on Vercel)

### 1. Update Frontend API URL

**Update `.env.production`** to point to your backend:
```
NEXT_PUBLIC_API_URL=https://your-backend.vercel.app
```

Replace `your-backend.vercel.app` with actual backend URL from step above.

### 2. Deploy Frontend to Vercel

**Option A: Via CLI**
```bash
cd frontend
vercel --prod
```

**Option B: Via GitHub (Recommended)**
1. Go to [vercel.com](https://vercel.com)
2. Click "New Project"
3. Import GitHub repository
4. Select `Next.js` as framework
5. Set root directory to `frontend/`
6. Add environment variable:
   ```
   NEXT_PUBLIC_API_URL=https://your-backend.vercel.app
   ```
7. Deploy

### 3. Get Frontend URL
After deployment, Vercel will show: `https://your-frontend.vercel.app`

---

## Testing Deployment

1. **Visit frontend:** https://your-frontend.vercel.app
2. **Test user form:** `/user` page
3. **Test admin dashboard:** `/admin` page
4. **Submit a review** and verify AI response works

---

## Troubleshooting

### Backend not responding
- Check environment variables are set in Vercel
- Verify DATABASE_URL is correct
- Check backend logs in Vercel dashboard

### Frontend can't reach backend
- Verify `NEXT_PUBLIC_API_URL` is set correctly
- Check CORS is enabled on backend
- Test backend directly: `curl https://your-backend.vercel.app/reviews`

### GEMINI_API_KEY errors
- Verify key is set in Vercel environment variables
- Check it's the correct format from Google AI Studio
- Redeploy after setting the variable

---

## File Structure for Deployment

```
backend/
├── vercel.json         (NEW - Vercel config)
├── index.py            (NEW - ASGI entry point)
├── app.py
├── llm.py
├── db.py
├── models.py
├── schemas.py
└── requirements.txt

frontend/
├── .env.production     (UPDATED - Production API URL)
├── vercel.json         (AUTO-GENERATED by Vercel)
├── app/
└── package.json
```

---

## Production Checklist

- [ ] Backend deployed to Vercel
- [ ] Backend URL noted
- [ ] Frontend `.env.production` updated with backend URL
- [ ] Frontend deployed to Vercel
- [ ] Environment variables set in Vercel dashboard
- [ ] CORS enabled on backend
- [ ] Database connection working
- [ ] Test form submission works
- [ ] Test admin dashboard loads reviews
- [ ] AI responses are unique per review

---

## Quick Deploy Commands

```bash
# Backend
cd backend
vercel --prod

# Frontend (after updating .env.production)
cd frontend
vercel --prod
```

---

## Need Help?

- Vercel Docs: https://vercel.com/docs
- FastAPI on Vercel: https://vercel.com/docs/frameworks/fastapi
- Next.js on Vercel: https://vercel.com/docs/frameworks/nextjs
